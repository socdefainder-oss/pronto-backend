#!/bin/bash

echo "ğŸš€ Deploy do Sistema de Banners Promocionais"
echo "============================================"
echo ""

# Backend
echo "ğŸ“¦ 1. Backend (Render)"
echo "   - Model Banner no Prisma âœ…"
echo "   - Migration 20260115164604_add_banners âœ…"
echo "   - API /api/banners (5 endpoints) âœ…"
echo "   - Rotas registradas no server.ts âœ…"
echo ""

# Frontend - Management Page
echo "ğŸ¨ 2. Frontend - PÃ¡gina de Gerenciamento"
echo "   - Arquivo: app/app/restaurant/[id]/banners/page.tsx âœ…"
echo "   - Funcionalidades:"
echo "     * Lista de banners com preview"
echo "     * Modal criar/editar"
echo "     * Toggle ativo/inativo"
echo "     * Deletar banner"
echo "     * Color pickers (fundo e texto)"
echo "     * Upload de imagem (URL)"
echo "     * PosiÃ§Ã£o (topo/meio/final)"
echo "     * Agendamento (data inÃ­cio/fim)"
echo ""

# Frontend - Dashboard Button
echo "ğŸ”˜ 3. Frontend - BotÃ£o no Dashboard"
echo "   - Script: add_banners_button.cjs"
echo "   - Execute: cd ../pronto.frontend && node ../pronto-backend/add_banners_button.cjs"
echo "   - Adiciona botÃ£o laranja 'Banners' ao lado de 'Cupons'"
echo ""

# Frontend - Public Display
echo "ğŸ‘ï¸  4. Frontend - ExibiÃ§Ã£o PÃºblica"
echo "   - Script: add_banners_to_menu.cjs"
echo "   - Execute: cd ../pronto.frontend && node ../pronto-backend/add_banners_button.cjs"
echo "   - Exibe banners ativos no topo do cardÃ¡pio"
echo "   - Filtra por data (startDate <= now <= endDate)"
echo "   - ClickÃ¡vel se tiver linkUrl"
echo ""

# Deploy Steps
echo "ğŸ“‹ PASSOS PARA DEPLOY:"
echo "====================="
echo ""
echo "BACKEND (pronto-backend):"
echo "  git add ."
echo "  git commit -m 'feat: add promotional banners system'"
echo "  git push"
echo "  (Render farÃ¡ deploy automÃ¡tico)"
echo ""
echo "FRONTEND (pronto.frontend):"
echo "  1. cd ../pronto.frontend"
echo "  2. node ../pronto-backend/add_banners_button.cjs"
echo "  3. node ../pronto-backend/add_banners_to_menu.cjs"
echo "  4. git add ."
echo "  5. git commit -m 'feat: add promotional banners UI'"
echo "  6. git push"
echo "  (Vercel farÃ¡ deploy automÃ¡tico)"
echo ""

# Testing
echo "ğŸ§ª COMO TESTAR:"
echo "==============="
echo "1. Acesse o dashboard do restaurante"
echo "2. Clique no botÃ£o 'Banners'"
echo "3. Crie um novo banner:"
echo "   - TÃ­tulo: PromoÃ§Ã£o de VerÃ£o"
echo "   - DescriÃ§Ã£o: 20% OFF em todos os produtos"
echo "   - Cor de fundo: #10b981 (verde)"
echo "   - Cor do texto: #ffffff (branco)"
echo "   - PosiÃ§Ã£o: Topo"
echo "   - Deixe ativo"
echo "4. Acesse o cardÃ¡pio pÃºblico (r/slug-do-restaurante)"
echo "5. Veja o banner exibido no topo"
echo "6. Clique no banner (se configurou linkUrl)"
echo ""

# API Endpoints
echo "ğŸ“¡ ENDPOINTS DA API:"
echo "==================="
echo "GET    /api/banners/restaurant/:restaurantId (auth)"
echo "       â†’ Lista todos os banners do restaurante"
echo ""
echo "GET    /api/banners/public/:restaurantId/active"
echo "       â†’ Lista banners ativos (pÃºblico, com filtro de data)"
echo ""
echo "POST   /api/banners (auth)"
echo "       â†’ Cria novo banner"
echo "       Body: { restaurantId, title, description?, imageUrl?,"
echo "               linkUrl?, backgroundColor, textColor, position,"
echo "               sortOrder, startDate?, endDate? }"
echo ""
echo "PUT    /api/banners/:id (auth)"
echo "       â†’ Atualiza banner (todos os campos opcionais)"
echo ""
echo "DELETE /api/banners/:id (auth)"
echo "       â†’ Deleta banner"
echo ""

# Database Schema
echo "ğŸ—„ï¸  SCHEMA DO BANCO:"
echo "==================="
echo "model Banner {"
echo "  id              String    @id @default(uuid())"
echo "  restaurantId    String"
echo "  restaurant      Restaurant @relation(fields: [restaurantId], references: [id], onDelete: Cascade)"
echo "  title           String"
echo "  description     String?"
echo "  imageUrl        String?"
echo "  linkUrl         String?"
echo "  backgroundColor String    @default(\"#10b981\")"
echo "  textColor       String    @default(\"#ffffff\")"
echo "  position        String    @default(\"top\")"
echo "  sortOrder       Int       @default(0)"
echo "  startDate       DateTime?"
echo "  endDate         DateTime?"
echo "  isActive        Boolean   @default(true)"
echo "  createdAt       DateTime  @default(now())"
echo "  updatedAt       DateTime  @updatedAt"
echo ""
echo "  @@index([restaurantId])"
echo "  @@index([isActive])"
echo "  @@index([position])"
echo "  @@index([sortOrder])"
echo "}"
echo ""

echo "âœ… Sistema de Banners Promocionais pronto para deploy!"
echo "ğŸ¯ PrÃ³ximo: Ofertas por tempo limitado"
